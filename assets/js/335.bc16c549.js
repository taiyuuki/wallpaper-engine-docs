(window.webpackJsonp=window.webpackJsonp||[]).push([[335],{698:function(t,a,s){"use strict";s.r(a);var e=s(26),n=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"tutorial-shader-programming-desaturation"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tutorial-shader-programming-desaturation"}},[t._v("#")]),t._v(" Tutorial: Shader Programming Desaturation")]),t._v(" "),s("h2",{attrs:{id:"adding-new-effect"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#adding-new-effect"}},[t._v("#")]),t._v(" Adding New Effect")]),t._v(" "),s("p",[t._v("Make sure you have enabled the "),s("a",{attrs:{href:"/wallpaper-engine-docs/scene/assets/sharing"}},[t._v("Asset Creation")]),t._v(" options in the editor!")]),t._v(" "),s("ul",[s("li",[t._v("Click on "),s("strong",[t._v("Add Effect")]),t._v(" on the right.")]),t._v(" "),s("li",[t._v("Click on "),s("strong",[t._v("New")]),t._v(" at the bottom of the dialog.")]),t._v(" "),s("li",[t._v("Enter a new name for the effect (in this example: "),s("em",[t._v('"Desaturate"')]),t._v(") and click OK.")])]),t._v(" "),s("video",{attrs:{width:"100%",controls:"",loop:"",autoplay:""}},[s("source",{attrs:{src:t.$withBase("/videos/shader_new.mp4"),type:"video/mp4"}}),t._v("\n  Your browser does not support the video tag.\n")]),t._v(" "),s("h2",{attrs:{id:"editing-the-shader"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#editing-the-shader"}},[t._v("#")]),t._v(" Editing the Shader")]),t._v(" "),s("p",[t._v("Click on "),s("strong",[t._v("Edit")]),t._v(" next to the fragment shader to open the shader editor. You will be presented with a default shader that does nothing but can be used as a starting point.")]),t._v(" "),s("p",[t._v("Add a new line of code just before "),s("strong",[t._v("albedo")]),t._v(" is returned to add a basic desaturation function:")]),t._v(" "),s("div",{staticClass:"language-glsl extra-class"},[s("pre",{pre:!0,attrs:{class:"language-glsl"}},[s("code",[t._v("albedo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rgb "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("CAST3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("dot")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("vec3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.11")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.59")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" albedo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rgb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("This code will take the current color of the image, make a "),s("em",[t._v("dot product")]),t._v(" with a constant vector (the "),s("code",[t._v("0.11, 0.59, 0.3")]),t._v(" constants are typically used to determine luminosity) and then turn the single resulting float into a vec3 by using the "),s("strong",[t._v("CAST3")]),t._v(" function. The fragment shader should now look like this:")]),t._v(" "),s("div",{staticClass:"language-glsl extra-class"},[s("pre",{pre:!0,attrs:{class:"language-glsl"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("uniform")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("sampler2D")]),t._v(" g_Texture0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// {"material":"framebuffer","label":"ui_editor_properties_framebuffer","hidden":true}')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("varying")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("vec4")]),t._v(" v_TexCoord"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("vec4")]),t._v(" albedo "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("texSample2D")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("g_Texture0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" v_TexCoord"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("xy"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\talbedo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rgb "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("CAST3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("dot")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("vec3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.11")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.59")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" albedo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rgb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\tgl_FragColor "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" albedo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("You can now click on "),s("strong",[t._v("OK")]),t._v(" on the right and you will already see that the image becomes fully desaturated through this new effect.")]),t._v(" "),s("h2",{attrs:{id:"making-the-effect-configurable"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#making-the-effect-configurable"}},[t._v("#")]),t._v(" Making the effect configurable")]),t._v(" "),s("p",[t._v("To make the effect a bit more useful, we'll add a slider to control how much the image will be desaturated. This can later also be combined with user properties or SceneScript for additional use-cases. Use the "),s("strong",[t._v("Snippets")]),t._v(" menu to create a new float slider.")]),t._v(" "),s("p",[t._v("Rename the slider variable and change the label, like this:")]),t._v(" "),s("div",{staticClass:"language-glsl extra-class"},[s("pre",{pre:!0,attrs:{class:"language-glsl"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("uniform")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("float")]),t._v(" u_DesaturationAmount"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// {"material":"Amount","default":1,"range":[0,1]}')]),t._v("\n")])])]),s("p",[t._v("Now add the new slider value to the code. Using the GLSL "),s("strong",[t._v("mix")]),t._v(" function we can blend between the original and desaturated color like this:")]),t._v(" "),s("div",{staticClass:"language-glsl extra-class"},[s("pre",{pre:!0,attrs:{class:"language-glsl"}},[s("code",[t._v("albedo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rgb "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mix")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("albedo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rgb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("CAST3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("dot")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("vec3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.11")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.59")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" albedo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rgb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\tu_DesaturationAmount"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("Click on "),s("strong",[t._v("OK")]),t._v(" in the shader editor and you should immediately see the slider appear below the shader edit buttons. Your new effect now has a slider that allows you to tweak the amount of desaturation easily and you can even bind a script or a user property to it.")]),t._v(" "),s("p",[t._v("You can see the steps from this section in the following video, including the finished effect:")]),t._v(" "),s("video",{attrs:{width:"100%",controls:"",loop:"",autoplay:""}},[s("source",{attrs:{src:t.$withBase("/videos/shader_desaturation_tutorial.mp4"),type:"video/mp4"}}),t._v("\n  Your browser does not support the video tag.\n")])])}),[],!1,null,null,null);a.default=n.exports}}]);